# Sleep Ritual — Telegram Mini App (MVP)

Мини-приложение для восстановления режима сна. Интерфейс адаптирован под Telegram Mini Apps (Bot API 8.0+) и работает полностью на HTML/CSS/Vanilla JS.

## Возможности

- **Онбординг за 1 минуту**: три последовательных шага (текущий подъём → цель → длительность челленджа 7/14/21 дней).
- **Автогенерация плана**: плавный сдвиг подъёмов + расчёт времени отхода ко сну (цель − 8 часов).
- **Экран «Сегодня»**: кольцо прогресса, план на день, мини-чеклист, фиксация фактических значений и настроения, автоматический расчёт цвета дня.
- **Экран «Прогресс»**: сетка челленджа, статистика (серии, лучшие серии, среднее время подъёма, счётчик зелёных дней).
- **Локальное хранение**: все настройки и дни сохраняются в `localStorage` (`sleepApp.*` ключи) и переживают перезапуск Telegram.
- **Интеграция с Telegram WebApp API**: вызовы `ready()`, `expand()` и `requestFullscreen()` (по действию пользователя) для полноценного полноэкранного режима.

## Структура

```
index.html   — разметка и контейнеры экранов
styles.css   — тёмный glassmorphism UI, mobile-first
app.js       — логика онбординга, прогресса, локального хранилища и Telegram API
```

## Запуск локально

1. Любой статический сервер. Пример: `npx serve .` или `python3 -m http.server 8080` в корне.
2. Откройте `http://localhost:8080` в браузере. Приложение работает автономно и без Telegram для тестов.

## Подключение как Telegram Mini App

1. Залейте сборку (эти три файла) на HTTPS-хостинг.
2. В @BotFather:
   - `/newapp` или настройка существующего бота → укажите URL и `app_short_name`.
   - Убедитесь, что у бота Bot API ≥ 8.0 для поддержки fullscreen.
3. В коде уже реализовано:
   - `Telegram.WebApp.ready()` → скрывает плейсхолдер.
   - `Telegram.WebApp.expand()` → сразу разворачивает WebView на максимальную высоту.
   - `Telegram.WebApp.requestFullscreen()` → запрашивается при инициализации и повторно на первом пользовательском жесте/при запуске челленджа; при отказе приложение остаётся в max-height и повторяет запрос при следующем взаимодействии.
4. Для прямых ссылок используйте `https://t.me/<bot_username>/<app_short_name>` без `mode=compact`, чтобы Telegram не открывал панель снизу.

## Данные и ключи

- `sleepApp.userId` — ID пользователя Telegram (или `local-user`, если запущено в браузере).
- `sleepApp.settings` — JSON с текущим подъёмом, целью, длительностью и датой старта.
- `sleepApp.days` — массив дней (цели, фактические значения, чеклист, цвет, настроение).
- `sleepApp.stats` — текущая и лучшая серия зелёных дней.

## Настройка UI

- Цвета и тематические параметры вынесены в корневые CSS-переменные (`styles.css`).
- Чеклист и сообщения легко кастомизируются в `app.js` (`CHECKLIST_TASKS`, `getFeedbackByColor`).
- Для micro-анимаций используются CSS transitions и обновление SVG-кольца.

Готово к дальнейшему развитию — можно подключать backend, трекинг или нотификации, не переписывая базовый UI.
